<!DOCTYPE html><html lang="korean"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Ajax | XMLHttpRequest | Dev diary</title><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/highlights/dracula.css"><link rel="canonical" href="http://yoursite.com/2018/04/10/ajax-xmlhttprequest/"/>
<meta name="description" content="XMLHttpRequest 인스턴스 생성대부분의 브라우저에서 XMLHttpRequest 객체의 새로운 인스턴스를 간단하게 만들 수 있다.1var xhr = new XMLHttpRequest(); 그러나 인터넷 익스플로러는 약간 복잡하다.액티브X…">
<meta name="keywords" content="Ajax">
<meta property="og:type" content="article">
<meta property="og:title" content="Ajax | XMLHttpRequest">
<meta property="og:url" content="http://yoursite.com/2018/04/10/ajax-xmlhttprequest/">
<meta property="og:site_name" content="Dev diary">
<meta property="og:description" content="XMLHttpRequest 인스턴스 생성대부분의 브라우저에서 XMLHttpRequest 객체의 새로운 인스턴스를 간단하게 만들 수 있다.1var xhr = new XMLHttpRequest(); 그러나 인터넷 익스플로러는 약간 복잡하다.액티브X…">
<meta property="og:locale" content="korean">
<meta property="og:image" content="http://yoursite.com/images/ajax.png">
<meta property="og:updated_time" content="2018-04-17T13:20:27.045Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ajax | XMLHttpRequest">
<meta name="twitter:description" content="XMLHttpRequest 인스턴스 생성대부분의 브라우저에서 XMLHttpRequest 객체의 새로운 인스턴스를 간단하게 만들 수 있다.1var xhr = new XMLHttpRequest(); 그러나 인터넷 익스플로러는 약간 복잡하다.액티브X…">
<meta name="twitter:image" content="http://yoursite.com/images/ajax.png"><meta property="article:author" content="circleGiven"><meta property="twitter:label1" content="Published at"><meta property="twitter:data1" content="2018-04-10 22:18:15"><meta property="twitter:label2" content="Written by"><meta property="twitter:data2" content="circleGiven"><link rel="icon" href="/images/favicon.png"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Dev diary"></head><body itemscope itemtype="https://schema.org/WebPage"><nav class="menu" id="menu"><div class="menu-inner"><div class="menu__left-area"><div class="menu__item"><a class="menu__item__link menu__item__link--brand" href="/" title="Home" rel="home"><img class="menu__item__link--brand__image" src="/images/favicon.png" alt="Dev diary"><span class="menu__item__link--brand__label">Dev diary</span></a></div></div><div class="menu__right-area"><div class="menu__item"><a class="menu__item__link" href="/">Home</a></div><div class="menu__item"><a class="menu__item__link" href="/archives">Archives</a></div></div></div></nav><div class="page-background"></div><div class="content-container"><div class="content-outer"><div class="content-inner" itemscope itemtype="https://schema.org/Blog"><article class="article" id="article" itemscope itemtype="https://schema.org/BlogPosting"><h1 class="article__title" itemprop="headline">Ajax | XMLHttpRequest</h1><div class="article__meta"><time class="article__meta__time" datetime="2018-04-10T13:18:15.000Z" itemprop="datePublished">2018-04-10 22:18:15</time><div class="article__meta__categories"><a class="article__meta__categories__item" href="/categories/Ajax/">Ajax</a></div></div><div class="article__contents"><img src="/images/ajax.png"/><h1 id="XMLHttpRequest-인스턴스-생성"><a href="#XMLHttpRequest-인스턴스-생성" class="headerlink" title="XMLHttpRequest 인스턴스 생성"></a>XMLHttpRequest 인스턴스 생성</h1><p>대부분의 브라우저에서 XMLHttpRequest 객체의 새로운 인스턴스를 간단하게 만들 수 있다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br></pre></td></tr></table></figure></p>
<p>그러나 인터넷 익스플로러는 약간 복잡하다.<br>액티브X 객체의 인스턴스를 만들어야 한다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var xhr = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br></pre></td></tr></table></figure></p>
<p>다른 브라우저에서는 이 방법을 사용해서는 안된다.<br>그러나 인터넷 익스플로러의 경우 내장 객체의 인스턴스를 생성하는 방법을 사용하면 안된다.<br>이런 문제를 해결하기 위해 인스턴스를 만들기 전에 객체가 존재하는지 여부를 미리 확인해야 한다.<br>이 방법을 <strong>객체 판별(object detection)</strong>이라 한다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getHttpObject</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 반환할 XMLHttpRequest 객체</span></span><br><span class="line">    <span class="keyword">var</span> xhr;</span><br><span class="line">    <span class="comment">// XMLHttpRequest 객체가 존재하는지</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.XMLHttpRequest) &#123;</span><br><span class="line">        xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.ActiveXObject) &#123;</span><br><span class="line">        xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> xhr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>만약 이 getHttpObject() 함수가 undefined를 반환한다면 브라우저에서 Ajax를 지원하지 않는다는 것이다.<br>이런 경우에 처리를 하면 Ajax를 지원하지 않는 브라우저에서도 적절하게 대응할 수 있다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> request = getHttpObject();</span><br><span class="line"><span class="comment">// 브라우저가 Ajax를 지원한다면</span></span><br><span class="line"><span class="keyword">if</span> (request) &#123;</span><br><span class="line">    <span class="comment">// Ajax 코드</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br><br>대부분은 위 getHttpObject() 함수가 잘 동작하지만, 브라우저가 액티브X를 지원하지만 Ajax를 위한 특정 액티브X가 존재하지 않는다면 문제가 된다.<br>이런 특별한 경우에는 액티브X의 존재 유무와 특정한 종류의 액티브X 객체의 존재 유무도 확인해야 한다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getHttpObject</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 반환할 XMLHttpRequest 객체</span></span><br><span class="line">    <span class="keyword">var</span> xhr;</span><br><span class="line">    <span class="comment">// XMLHttpRequest 객체가 존재하는지</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.XMLHttpRequest) &#123;</span><br><span class="line">        xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.ActiveXObject) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Msxm12.XMLHTTP"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                xhr = <span class="literal">undefined</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> xhr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br><br><br></p>
<h1 id="요청-보내기"><a href="#요청-보내기" class="headerlink" title="요청 보내기"></a>요청 보내기</h1><p>XMLHttpRequest의 인스턴스를 만든 후에는 서버와 통신하기 위한 준비가 필요하다.</p>
<ul>
<li>onreadystatechange 이벤트 핸들러</li>
<li>open 메서드</li>
<li>send 메서드</li>
</ul>
<h2 id="onreadystatechange-이벤트-핸들러"><a href="#onreadystatechange-이벤트-핸들러" class="headerlink" title="- onreadystatechange 이벤트 핸들러"></a>- onreadystatechange 이벤트 핸들러</h2><p>이벤트 핸들러를 사용하면 이벤트가 발생했을 때 어떠한 동작이 일어나게 할 것인지를 지정할 수 있다.</p>
<p>대부분의 이벤트는 사용자에 의해 발생한다.<br>사용자가 커서를 웹 페이지의 어떤 요소에 올리는 경우, mouseover 이벤트가 발생한다.<br>이와 대응하는 이벤트 핸들러는 onmouseover다.<br>사용자가 폼을 전송할 때 submit 이벤트가 발생하는데,<br>이와 대응하는 이벤트 핸들러는 onsubmit이다.</p>
<p>이벤트 핸들러는 자바스크립트가 웹에서 성공할 수 있었던 결정적인 특징이다.<br>마우스의 움직임에 따라 이미지를 변경하거나 폼이 올바른지 확인하는 작업들은 onmouseover, onmouseout, onblur, onsubmit과 같은 이벤트 핸들러를 사용하여 이루어진다.</p>
<p>사용자가 모든 이벤트를 발생시키는 것은 아니다.<br>load 이벤트는 웹 브라우저 창에서 문서의 로딩이 완료되었을 때 발생한다.<br>이에 해당하는 이벤트 핸들러는 window.onload다.</p>
<p><strong>onreadystatechange</strong> 이벤트 핸들러는 사용자가 아닌 서버에 의해 발생하는 이벤트를 처리하는데 사용한다.<br><strong>Ajax가 실행되는 동안, 서버는 현재 통신 상태에 대한 정보를 클라이언트에 업데이트 한다.</strong><br>이 작업은 XMLHttpRequest 객체의 프로퍼티 값을 변경하게 된다.<br>이떄 변경되는 프로퍼티 값은 <strong>readystate</strong>라는 값이다.<br>여기서 readystate 프로퍼티 값이 변경될 때마다 <strong>readystatechange</strong> 이벤트가 발생한다.<br>readystatechange 이벤트가 발생하여 onreadystatechange 이벤트 핸들러가 동작한다는 것은 서버에서 어떠한 작업이 일어나고 있다는 뜻이다.<br><strong>서버가 readystate 프로퍼티 값을 변경시키는 것은 클라이언트에게 신호를 보내는 방법이다.</strong></p>
<p>함수를 onreadystatechange 이벤트 핸들러에 연결하면, 서버가 업데이트 되었다는 신호를 클라이언트에 보낼 때마다 지정한 함수가 실행된다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> request = getHttpObject();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (request) &#123;</span><br><span class="line">    request.onreadystatechange = doSomething;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>여기에서 doSomething() 함수에 대한 참조를 onreadystatechange 이벤트 핸들러에 할당했다.<br>doSomething() 함수는 readystatechange 이벤트가 발생할 때마다 실행된다.<br><br><br></p>
<h2 id="open-메서드"><a href="#open-메서드" class="headerlink" title="- open 메서드"></a>- open 메서드</h2><p>웹 브라우저가 웹 서버로부터 페이지를 전송받으려 할 때, 웹 브라우저는 요청을 보낸다.<br>이 요청에는 <strong>브라우저가 전송받으려고 하는 파일의 서버에서의 위치정보</strong>가 들어있다.<br>사용자가 폼을 이용해서 입력한 데이터와 같은 추가적인 정보가 포함되어 있을 수도 있다.<br><strong>브라우저가 어떤 방법을 사용하여 요청을 서버에 보냈는지에 대한 정보</strong>도 같이 들어있다.<br>이러한 요청은 일반적으로 <code>GET</code> 요청이다.<br>하지만 많은 데이터를 서버로 보내야 할 경우 웹 브라우저는 <code>POST</code> 요청을 사용한다.</p>
<p>XMLHttpRequest 객체의 open 메서드를 사용하면 이러한 동작을 Ajax에서도 동일하게 반복할 수 있다.<br>open 메서드를 사용하려면 두 개의 파라메터가 필요하다.</p>
<ul>
<li>요청의 종류(요청 방법)</li>
<li>서버에서의 파일 위치(URL)</li>
</ul>
<p><br></p>
<h3 id="gt-요청-방법"><a href="#gt-요청-방법" class="headerlink" title="&gt; 요청 방법"></a>&gt; 요청 방법</h3><p>open 메서드의 첫 번째 인자는 “GET” 혹은 “POST” 와 같은 문자열이다.<br>어떠한 데이터도 서버로 보내지 않고 <strong>서버로 부터 단순히 파일을 받으려고 하는 경우에는 <code>GET</code> 요청</strong>을,<br><strong>서버에 데이터를 보내려고 하는 경우에는 <code>POST</code> 요청</strong>을 사용하면 된다.<br>그 밖의 요청 방법에는 <code>PUT</code>, <code>DELETE</code>, <code>HEAD</code>와 같은 것들이 있다.</p>
<p><code>GET</code> 요청을 보낼 때, 보내려고 하는 URL 뒤에 <strong>질의 문자열(query string)</strong>을 덧붙여서 데이터를 서버로 보낼 수 있다.<br>그러나 이 방법으로는 서버로 보낼 수 있는 데이터의 길이에 제한이 있다.<br>또한 데이터베이스의 레코드를 수정하거나 삭제하는 작업과 같이 서버에서 무엇인가 변경하는 작업에는 절대로 <code>GET</code> 요청을 사용하면 안된다.<br><br><br></p>
<h3 id="gt-URL"><a href="#gt-URL" class="headerlink" title="&gt; URL"></a>&gt; URL</h3><p>open 메서드의 두 번째 인자는 서버에 존재하고, 요청하고자 하는 파일의 위치를 가리키는 문자열이다.<br>파일의 위치는 “…/myfile.html”과 같은 형태의 상대 경로로 표현할 수 있고, “/file/myfile.html”과 같은 절대 경로로 표현할 수도 있다.<br>다음과 같이 요청하고자 하는 파일에 대한 완전한 경로를 사용할 수도 있다.</p>
<blockquote>
<p><a href="http://www.example.com/files/myfile.html" target="_blank" rel="noopener">http://www.example.com/files/myfile.html</a></p>
</blockquote>
<p>요청하고자 하는 파일은 요청 작업을 수행하는 자바스크립트 파일과 동일한 도메인에 존재해야 한다.<br>자바스크립트 파일을 foo.com에서 가져와 실행하고 있다면, bar.com에서 파일을 가져올 수 없다.<br>(XMLHttpRequest을 사용하여 가져올 수 있는 파일이 도메인에 의해 제한되어 있다.)<br><br><br></p>
<h3 id="gt-비동기-요청"><a href="#gt-비동기-요청" class="headerlink" title="&gt; 비동기 요청"></a>&gt; 비동기 요청</h3><p>open 메서드는 요청 방법과 URL 두 개의 인자뿐 아니라 추가 인자를 받을 수 있다.<br><strong>세 번째 인자로 <code>boolean</code> 을 사용할 수 있다.<br>이 값은 요청을 비동기적으로 처리할 것인지 동기적으로 처리할 것인지 지정하는 값이다.</strong></p>
<p>이 값을 true로 할 경우, 스크립트는 비동기적인 요청을 수행한다.<br><strong>비동기적인 요청</strong>이라는 것은 서버로 요청을 보내고 난 후 서버의 응답을 기다리지 않고 스크립트 코드의 나머지 부분을 실행하는 것을 의미한다.</p>
<p>이 값을 false로 할 경우, 스크립트의 실행은 요청을 보내는 지점에서 중단된다.<br>스크립트는 Ajax 요청이 완료될 때까지 실행되지 않는다.</p>
<p>스크립트의 실행을 중단시키는 것은 절대로 좋은 생각이 아니다.<br>서버가 처리하는데 오랜 시간이 걸리는 경우, 브라우저는 동작하지 않을 것이다.<br>Ajax의 최고의 장점 중 하나는 브라우저에서 사용자의 인터랙션을 처리하는 동안 백그라운드로 요청을 처리할 수 있는 점이다.<br>이러한 기능을 사용하려면 항상 open 메서드의 세 번째 인자로 true 값을 설정해야 한다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.open(<span class="string">"GET"</span>, <span class="string">"file.ext"</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure></p>
<p><br><br></p>
<h3 id="gt-사용자-이름과-암호"><a href="#gt-사용자-이름과-암호" class="headerlink" title="&gt; 사용자 이름과 암호"></a>&gt; 사용자 이름과 암호</h3><p>open 메서드에서는 서버로 전송할 사용자 이름과 암호를 추가 인자로 사용할 수 있다.<br>그러나 자바스크립트 파일에 중요한 정보를 직접 적어서는 안된다.<br>즉 open 메서드를 다음과 같이 사용해서는 안된다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.open(<span class="string">"GET"</span>, <span class="string">"file.ext"</span>, <span class="literal">true</span>, <span class="string">"circleGiven"</span>, <span class="string">"pw1234"</span>);</span><br></pre></td></tr></table></figure></p>
<p>누구나 웹 페이지나 CSS 파일의 코드를 볼 수 있는 것처럼 자바스크립트 코드도 볼 수 있다.<br>읽기 어렵게 만들 수는 있지만 완전히 감출 수는 없다.</p>
<p>폼을 통해 입력한 값을 open 메서드의 사용자 이름과 암호로 사용할 수도 있다.<br>적어도 이런 방법을 사용하여 사용자 이름과 암호를 직접 파일에 작성하는 것은 피해야한다.<br>그러나 실제로 사용자 이름과 암호를 인자로 사용할 일은 거의 없을 것이다.<br><br><br><br></p>
<h2 id="보내기"><a href="#보내기" class="headerlink" title="- 보내기"></a>- 보내기</h2><p>open 메서드를 사용하여 어떤 Ajax 요청을 할 것인지 설정하자.<br>그러나 요청을 서버로 보내지는 않을 것이다.<br>open 메서드를 사용하여 준비했던 요청을 서버로 보내기 위해서는 <strong>send</strong> 메서드를 사용해야 한다.</p>
<p>send 메서드는 하나의 인자를 받는다.</p>
<p><code>GET</code> 요청 방식을 사용하는 경우, 어떤 데이터도 보내지 않아야 한다.<br>이를 위해 send 메서드에 null을 인자로 설정한다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.send(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure></p>
<p>완전한 형태의 <code>GET</code> 요청은 다음과 같다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> request = getHTTPObject();</span><br><span class="line"><span class="keyword">if</span> (request) &#123;</span><br><span class="line">    request.onreadystatechange = doSomething;</span><br><span class="line">    request.open(<span class="string">"GET"</span>, <span class="string">"file.ext"</span>, <span class="literal">true</span>);  <span class="comment">// 아직 요청이 전달되지 않는다</span></span><br><span class="line">    request.send(<span class="literal">null</span>); <span class="comment">// 여기서 전달된다.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>데이터를 서버로 보내야 할 경우 <code>POST</code> 요청 방법을 사용해야 한다.<br>다음과 같은 형태로 <strong>질의 문자열</strong>을 보내면 된다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"name=Justin+Jang&amp;message=Hello+world"</span></span><br></pre></td></tr></table></figure></p>
<p>질의 문자열은 이름과 값의 쌍이 <code>&amp;</code>로 연결되어 있습니다. 각각의 이름과 값들은 <strong>URL 인코딩</strong>이 되어있어야 한다.<br>URL 인코딩이 되어 있다는 것은 공백문자는 <code>+</code>기호로 변환되고, 영문자와 숫자가 아닌 문자들은 16진수 값으로 인코딩되어야 한다는 의미이다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @ 기호는 아래처럼 변환된다</span></span><br><span class="line"><span class="string">"%40"</span></span><br></pre></td></tr></table></figure></p>
<p>데이터를 전송하기 위해서는 <strong>XMLHttpRequest</strong> 객체가 제공하는 또 하나의 메서드를 사용할 필요가 있다.<br><br><br></p>
<h3 id="gt-setRequestHeader"><a href="#gt-setRequestHeader" class="headerlink" title="&gt; setRequestHeader"></a>&gt; setRequestHeader</h3><p>웹 브라우저가 웹 서버에게 페이지를 요청할 때, 웹 브라우저는 요청과 함꼐 여러 가지 헤더 정보들을 보낸다.<br>이 헤더 정보는 요청에 대한 설명을 담고 있는 여러 가지 속성정보로 이뤄져 있다.<br>어떤 헤더정보는 요청이 <code>GET</code>인지 <code>POST</code>인지를 선언하는 데 사용된다.</p>
<p>Ajax에서는 헤더정보를 보내는 기능을 <strong>setRequestHeader</strong>라는 메서드를 사용하여 구현한다.<br>이 메서드는 문자열로 된 두 개의 인자를 받는다.<br>첫 번째 문자열은 <strong>헤더 정보의 이름</strong>이며, 두 번째 문자열은 <strong>헤더 정보의 값</strong>이다.</p>
<p><code>POST</code> 요청 방식으로 데이터를 서버로 보낼 경우,<br><strong>“content-type”</strong> 헤더정보를 <strong>“application/x-www-form-urlencoded”</strong>로 설정해야 한다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.setRequestHeader(<span class="string">"content-type"</span>, <span class="string">"application/x-www-form-urlencoded"</span>);</span><br></pre></td></tr></table></figure></p>
<p>이렇게 함으로써 서버에게 전송되는 데이터가 URL 인코딩이 되어있다는 사실을 알려줄 수 있다.<br>완전한 형태의 <code>POST</code> 요청은 다음과 같다.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> request = getHTTPObject();</span><br><span class="line"><span class="keyword">if</span> (request) &#123;</span><br><span class="line">    request.onreadystatechange = doSomething;</span><br><span class="line">    request.open(<span class="string">"POST"</span>, <span class="string">"file.ext"</span>, <span class="literal">true</span>);  <span class="comment">// 아직 요청이 전달되지 않는다</span></span><br><span class="line">    request.setRequestHeader(<span class="string">"content-type"</span>, <span class="string">"application/x-www-form-urlencoded"</span>); <span class="comment">// 헤더정보 설정</span></span><br><span class="line">    request.send(<span class="string">"name=Justin+Jang&amp;message=Hello+world"</span>); <span class="comment">// 여기서 전달된다.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br><br></p>
<h2 id="응답-받기"><a href="#응답-받기" class="headerlink" title="- 응답 받기"></a>- 응답 받기</h2><p>서버로 요청을 보낼 때는 XMLHttpRequest 객체의 여러 가지 메서드를 사용한다.<br>메서드 외에 XMLHttpRequest 객체에는 여러 가지 프로퍼티 값이 있는데,<br>이러한 프로퍼티 값은 Ajax를 사용한 처리가 진행되는 동안 서버에 의해 업데이트 된다.</p>
<h3 id="gt-readyState"><a href="#gt-readyState" class="headerlink" title="&gt; readyState"></a>&gt; readyState</h3><p>readyState 프로퍼티는 Ajax 요청의 현재 상태를 나타낸다.<br>프로퍼티 값은 숫자다.</p>
<ul>
<li><strong>0</strong> : 초기화 되지 않음, open 메서드가 아직 호출되지 않음</li>
<li><strong>1</strong> : 열기, open 메서드가 호출되었으나 send 메서드가 호출되지 않음</li>
<li><strong>2</strong> : 송신완료, send 메서드가 호출되었고 요청이 시작됨</li>
<li><strong>3</strong> : 수신중, 서버가 응답을 보내는 중</li>
<li><strong>4</strong> : 수신완료, 서버가 응답을 보내고 작업을 완료함</li>
</ul>
<p>readyState 값이 변경될 때마다 readystatechange 이벤트가 발생한다.<br>onreadystatechange 이벤트 핸들러에 할당된 함수가 있는 경우 readyState의 값이 변경될 때마다 해당 함수가 실행된다.</p>
<blockquote>
<p>이론상 readyState 프로퍼티의 값은 0부터 4까지 순서대로 변경된다.<br>그러나 실제로는 브라우저마다 readyState의 값이 변하는 순서가 다르다.<br>그래도 요청이 완료되었을 때는 브라우저와 관계없이 readyState의 값은 4가 된다.</p>
<p>readyState 프로퍼티 값이 변할 때마다 어떤 작업을 하는 것보다는 readyState의 값이 4가 될때까지 기다리는 것이 좋다.</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (request.readyState === <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="comment">// 응답후 처리해야할 작업</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">request.onreadystatechange = doSomething;</span><br></pre></td></tr></table></figure>
<p>doSomething() 함수는 onreadystatechange 이벤트 핸들러에 할당되어 있기 때문에 여러 번 실행된다.<br>단 readyState 값이 4일 경우에만 작업이 실행된다.</p>
</div><div class="article__tags"><a class="article__tags__item" href="/tags/Ajax/">Ajax</a></div><div class="article__author" itemscope itemprop="author" itemtype="https://schema.org/Person"><img class="article__author__image" src="/images/profile.jpeg" alt="circleGiven"><a class="article__author__link" title="About circleGiven" rel="author">circleGiven</a><p class="article__author__desc">아직 배울게 너무 많은 '초보 개발자'</p><div class="article__author__socials"><a class="article__author__socials__item" href="https://github.com/circleGiven" title="github" target="_blank"><i class="fa fa-github"></i></a><a class="article__author__socials__item" href="https://www.linkedin.com/in/wonjune/" title="linkedin" target="_blank"><i class="fa fa-linkedin"></i></a><a class="article__author__socials__item" href="/atom.xml" title="rss" target="_blank"><i class="fa fa-rss"></i></a></div><meta itemprop="name" content="circleGiven"></div><div class="sharer" id="sharer"><div class="sharer-inner"><div class="sharer__right"><button class="sharer__item" id="sharer-facebook"><i class="fa fa-facebook-official"></i></button><button class="sharer__item" id="sharer-twitter"><i class="fa fa-twitter"></i></button><button class="sharer__item" id="sharer-pinterest"><i class="fa fa-pinterest"></i></button><button class="sharer__item" id="sharer-pocket"><i class="fa fa-get-pocket"></i></button></div></div></div><!-- Disqus Code--><div id="disqus_thread"></div><script>(function() {
  var d = document, s = d.createElement('script');
  s.src = '//circleGiven.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Enable JavaScript to see comments.</noscript><!-- Meta Tags for Structured Data--><meta itemprop="dateModified" content="2018-04-17T13:20:27.045Z"><meta itemprop="articleBody" content="XMLHttpRequest 인스턴스 생성대부분의 브라우저에서 XMLHttpRequest 객체의 새로운 인스턴스를 간단하게 만들 수 있다.1var xhr = new XMLHttpRequest();
그러나 인터넷 익스플로러는 약간 복잡하다.액티브X 객체의 인스턴스를 만들어야 한다.1var xhr = new..."><meta itemprop="url" content="http://yoursite.com/2018/04/10/ajax-xmlhttprequest/"><meta itemprop="mainEntityOfPage" content="http://yoursite.com/2018/04/10/ajax-xmlhttprequest/"><div itemscope itemtype="https://schema.org/Organization" itemprop="publisher"><meta itemprop="name" content="Dev diary"><div itemscope itemprop="logo" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="http://yoursite.com/images/favicon.png"></div></div><div itemscope itemtype="https://schema.org/ImageObject" itemprop="image"><meta itemprop="contentUrl" content="http://yoursite.com/images/ajax.png"><meta itemprop="url" content="http://yoursite.com/images/ajax.png"><meta itemprop="width"><meta itemprop="height"></div></article><section class="related-posts"><h3>Related posts</h3><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/2018/04/03/ajax-description/"><div class="related-posts__item__background" style="background-image:url('/images/ajax.png');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">Ajax | Ajax란?</span></a></div></section></div></div></div><footer id="footer"><div class="widgets"><div class="widgets-inner"><!-- Jade doesn't support dynamic inclusion with `each`.--><!-- So, I just hard coded the file names that will be included.--><div class="widgets__item"><h3 class="widgets__item__heading">Recent posts</h3><ul class="recent-posts"><li class="recent-posts__item"><a href="/2018/04/13/spring-ioc/">Spring | 컨테이너와 결합도</a></li><li class="recent-posts__item"><a href="/2018/04/10/ajax-xmlhttprequest/">Ajax | XMLHttpRequest</a></li><li class="recent-posts__item"><a href="/2018/04/04/spring-framework/">Spring | 스프링 프레임워크란?</a></li><li class="recent-posts__item"><a href="/2018/04/03/ajax-description/">Ajax | Ajax란?</a></li><li class="recent-posts__item"><a href="/2018/03/31/javascript-dom/">Javascript | 문서 객체 모델 (DOM)</a></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Archives</h3><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">9</span></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Categories</h3><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Ajax/">Ajax</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Book/">Book</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/">Javascript</a><span class="category-list-count">13</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/Basic/">Basic</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/Typescript/">Typescript</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Program/">Program</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Program/SICP/">SICP</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Programming/">Programming</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Programming/Story/">Story</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Server/">Server</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Speech/">Speech</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/Basic/">Basic</a><span class="category-list-count">2</span></li></ul></li></ul></div></div></div><p class="copyright"><small>© 2018 circleGiven<br>Powered by <a href="https://hexo.io" rel="external" target="_blank">Hexo</a>, Theme by <a href="https://github.com/hyunseob" rel="external" target="_blank">HyunSeob</a></small></p></footer><script src="/js/sharer.min.js"></script></body></html>